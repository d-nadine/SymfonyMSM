(function(){var g={};
(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Ob=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Mb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function r(){this.a={}}r.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};r.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function ba(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function ca(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function da(a){var b=[],c;for(c in a.a)b.push(c);return b};function ea(a){this.b=a;this.a=new fa(a);ga||(ga=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ga;
function w(a){var b;b=ha(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=ha(a);a:{for(d=0;d<ga.length;d++)if(ia(c,ga[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);ja(a.a,c);return new ka(b,d)}function ha(a){var b=la(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=la(a.a);return d}function ka(a,b){this.id=a;this.a=b}
function ma(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function na(){return Date.now()+oa}var oa=0;function x(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=x.prototype.destroy;return c}x.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function z(a,b){return b.bind(a)};function pa(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function qa(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function ra(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",ra);function sa(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",sa);function ua(a,b){var c=void 0==b?!0:b,d=window.btoa(ra(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}n("shaka.util.Uint8ArrayUtils.toBase64",ua);function va(a){return sa(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",va);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function wa(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",wa);function ia(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};var xa={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function ya(a){return Object.keys(a).map(function(b){return a[b]})}function za(a,b){var c=Aa(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function Ba(a,b){return Aa(a,b,"string")}function Aa(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function Ca(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function Da(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Ea)}n("shaka.polyfill.CustomEvent.install",Da);function Ea(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function Fa(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Ha)}n("shaka.polyfill.VideoPlaybackQuality.install",Fa);function Ha(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Ia(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
Ja);document.addEventListener("webkitfullscreenerror",Ja);document.addEventListener("mozfullscreenchange",Ja);document.addEventListener("mozfullscreenerror",Ja);document.addEventListener("MSFullscreenChange",Ja);document.addEventListener("MSFullscreenError",Ja)}n("shaka.polyfill.Fullscreen.install",Ia);function Ja(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function Ka(){}function La(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}La("error");La("warn");La("info");La("log");La("debug");function Ma(a){Na[a]={na:Oa(),end:NaN}}function Pa(a){if(a=Na[a])a.end=Oa()}function Qa(a){return(a=Na[a])&&a.end?a.end-a.na:NaN}var Oa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,Na={};function Ra(){};function fa(a){var b=Sa;this.b=a;this.c=b==Ta;this.a=0}var Sa=0,Ta=1;function Ua(a){return a.a<a.b.byteLength}function la(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function A(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Va(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Wa(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function ja(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function Xa(){this.a=new r}Xa.prototype.destroy=function(){Ya(this);this.a=null};function B(a,b,c,d){b=new Za(b,c,d);a.a.push(c,b)}Xa.prototype.sa=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.sa(),ca(this.a,b,e))}};function Ya(a){for(var b=ba(a.a),c=0;c<b.length;++c)b[c].sa();a.a.a={}}function Za(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Za.prototype.sa=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function $a(a){this.systemIds=[];this.cencKeyIds=[];a=new fa(new DataView(a.buffer));try{for(;Ua(a);){var b=a.a,c=A(a),d=A(a);1==c?c=Va(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)ja(a,c-(a.a-b));else{var e=la(a);if(1<e)ja(a,c-(a.a-b));else{ja(a,3);var f=wa(Wa(a)),g=[];if(0<e)for(var h=A(a),k=0;k<h;++k){var m=wa(Wa(a));g.push(m)}var p=A(a);ja(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&ja(a,c-(a.a-b))}}}}catch(t){}};function C(a){this.xa=new r;this.i=a}n("shaka.util.FakeEventTarget",C);C.prototype.addEventListener=function(a,b,c){c||this.xa.push(a,b)};C.prototype.removeEventListener=function(a,b,c){c||ca(this.xa,a,b)};C.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return ab(this,a)};
function ab(a,b){b.currentTarget=a;for(var c=a.xa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.i&&b.bubbles&&ab(a.i,b);return b.defaultPrevented};function bb(){this.g=new x;this.f=!1;this.a=null;this.b=[];this.c=null}function cb(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}bb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});db(this,void 0)};bb.prototype.end=function(){this.b.splice(1)};
function db(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(z(a,function(a){this.a?(this.b=[],this.c=null,eb(this)):(this.b.shift(),this.b.length?db(this,a):(this.g.resolve(a),this.c=null))})).catch(z(a,function(a){this.b=[];this.c=null;this.a?eb(this):this.g.reject(a)}))}function eb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function fb(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}fb.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function gb(a){return a.b/(1-Math.pow(a.c,a.a))};function D(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function E(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function hb(){C.call(this,null);this.a=new fb(3);this.c=new fb(10);this.b=0}q(hb,C);n("shaka.util.EWMABandwidthEstimator",hb);hb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(D({type:"bandwidth"}));this.b=Date.now()}};hb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(gb(this.a),gb(this.c))};hb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
hb.prototype.supportsCaching=function(){return!1};function ib(a,b,c){jb(b);jb(c);return c==b||a>=kb&&c==b.split("-")[0]||a>=lb&&c.split("-")[0]==b.split("-")[0]?!0:!1}var kb=1,lb=2;function jb(a){a=a.toLowerCase().split("-");var b=mb[a[0]];b&&(a[0]=b);return a.join("-")}
var mb={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function nb(a,b){C.call(this,b);this.a=null;this.h=a}q(nb,C);
function ob(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),Promise.reject(a);var b=new x,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=z(a,function(a){this.a=a.target.result;pb(this,"group_store",{keyPath:"group_id"});pb(this,"stream_index_store",{keyPath:"stream_id"});a=pb(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],
{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=z(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function F(a){a.a&&(a.a.close(),a.a=null)}function pb(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function qb(a){return rb(a,"content_store")}function sb(a){return rb(a,"stream_index_store")}function tb(a){return rb(a,"group_store")}
function rb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function ub(a,b){var c=new x,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function vb(){nb.call(this,"readonly",null)}q(vb,nb);function wb(a){var b=new x,c=[],d=tb(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function xb(a,b){return ub(tb(a),b).then(z(a,function(a){a.session_ids=pa(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):yb(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;return Promise.resolve(a)})}))}function yb(a,b){return ub(sb(a),b)}function zb(a,b,c){return ub(qb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Ab(a,b){try{var c=new Bb(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Cb(a){var b=this.mediaKeys;b&&b!=a&&Db(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Db(a,this);return Promise.resolve()}
function Bb(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},k=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var p=g.audioCapabilities[m];
p.contentType&&(k=!0,e.canPlayType(p.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(p),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)p=g.videoCapabilities[m],p.contentType&&(k=!0,e.canPlayType(p.contentType,this.a)&&(h.videoCapabilities.push(p),d=!0));k||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}Bb.prototype.createMediaKeys=function(){var a=new Fb(this.a);return Promise.resolve(a)};Bb.prototype.getConfiguration=function(){return this.b};function Fb(a){this.g=a;this.b=null;this.a=new Xa;this.c=[];this.f={}}function Db(a,b){a.b=b;Ya(a.a);b&&(B(a.a,b,"webkitneedkey",a.Bb.bind(a)),B(a.a,b,"webkitkeymessage",a.Ab.bind(a)),B(a.a,b,"webkitkeyadded",a.yb.bind(a)),B(a.a,b,"webkitkeyerror",a.zb.bind(a)))}l=Fb.prototype;
l.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new Gb(a,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};l.Bb=function(a){a=D({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
l.Ab=function(a){var b=Hb(this,a.sessionId);b&&(a=D({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};l.yb=function(a){if(a=Hb(this,a.sessionId))Ib(a,"usable"),a.a&&a.a.resolve(),a.a=null};
l.zb=function(a){var b=Hb(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Ib(b,"output-restricted"):1==c?Ib(b,"expired"):Ib(b,"internal-error"))}};
function Hb(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function Gb(a,b,c){C.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new x;this.keyStatuses=new Jb}q(Gb,C);
function Kb(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=sa("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=sa("PERSISTENT|"+ra(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new x;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}l=Gb.prototype;l.Ia=function(a,b){if(this.a)this.a.then(this.Ia.bind(this,a,b)).catch(this.Ia.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=ra(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=va(d.keys[0].k),d=va(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function Ib(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=D({type:"keystatuseschange"});a.dispatchEvent(c)}l.generateRequest=function(a,b){return Kb(this,b,null)};l.load=function(a){return"persistent-license"==this.g?Kb(this,null,a):Promise.reject(Error("Not a persistent session."))};l.update=function(a){var b=new x;this.Ia(b,a);return b};
l.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};l.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function Lb(a){this.b=a;this.a=0}
Lb.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function Jb(){this.size=0;this.a=void 0}var Mb;l=Jb.prototype;l.entries=function(){var a=Mb,b=[];this.a&&b.push([a,this.a]);return new Lb(b)};l.forEach=function(a){this.a&&a(this.a)};l.get=function(a){if(this.has(a))return this.a};l.has=function(a){var b=Mb;return this.a&&ia(new Uint8Array(a),b)?!0:!1};l.keys=function(){var a=Mb,b=[];this.a&&b.push(a);return new Lb(b)};
l.values=function(){var a=[];this.a&&a.push(this.a);return new Lb(a)};function Nb(){return Promise.reject(Error("The key system specified is not supported."))}function Ob(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Pb(){throw new TypeError("Illegal constructor.");}Pb.prototype.createSession=function(){};Pb.prototype.setServerCertificate=function(){};function Qb(){throw new TypeError("Illegal constructor.");}Qb.prototype.getConfiguration=function(){};Qb.prototype.createMediaKeys=function(){};function Rb(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(Mb=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=Ab,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Cb,window.MediaKeys=Fb,window.MediaKeySystemAccess=Bb):(Navigator.prototype.requestMediaKeySystemAccess=Nb,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ob,window.MediaKeys=Pb,window.MediaKeySystemAccess=Qb))}n("shaka.polyfill.MediaKeys.install",Rb);n("shaka.polyfill.installAll",function(){Da();Ia();Rb();Fa()});function G(){this.fontSize="100%";this.fontColor=Sb;this.fontOpacity=Tb;this.backgroundColor=Ub;this.backgroundOpacity=Tb;this.fontEdge=Vb}n("shaka.player.TextStyle",G);G.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};G.prototype.load=G.prototype.a;G.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
G.prototype.store=G.prototype.b;function Wb(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+Xb(a.fontColor,a.fontOpacity));b.push("background-color: "+Xb(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(Xb(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function Xb(a,b){return"rgba("+a.concat(b).join(",")+")"}var Sb=[255,255,255],Ub=[0,0,0];
G.StandardColors={WHITE:Sb,BLACK:Ub,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var Tb=1;G.StandardOpacities={OPAQUE:Tb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var Vb=[];
G.EdgeStyles={NONE:Vb,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function Yb(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function Zb(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function $b(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.j=a;this.c=b;this.l=c;this.h=new Xa;this.b=[];this.u=0;this.f=this.a=null;this.o=0;B(this.h,this.c,"updateend",this.w.bind(this))}var ac=1/60;$b.prototype.destroy=function(){bc(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};
function cc(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-ac,f=c.end(d)+ac;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function dc(a,b,c,d){if(a.a)return a=Error("Cannot fetch ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new bb;c!=a.c.timestampOffset&&(a.c.timestampOffset=c);d&&cb(a.a,function(){return[ec(this,d),this.g.bind(this)]}.bind(a));cb(a.a,function(){var a=b.a?b.a-b.b:1,c=new fc;c.a=3;c.g=1E3*a;c.c=1E3*this.o;return[gc(b.url,c,this.l),H.prototype.g.bind(b.url)]}.bind(a));cb(a.a,z(a,function(a){this.l.getBandwidth();return[ec(this,a),this.g.bind(this)]}));var e=0==a.c.buffered.length&&
0==a.b.length,f=null;cb(a.a,function(){if(0==this.c.buffered.length){var a=Error("Failed to buffer segment ("+this.i+").");a.type="stream";return[Promise.reject(a)]}e&&(a=b.b,f=this.c.buffered.start(0)-a);a=hc(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return ic(a).then(function(){return Promise.resolve(f)}.bind(a))}
function jc(a){if(a.a)return a=Error("Cannot clear ("+a.i+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new bb;cb(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new x}return[a,this.g.bind(this)]}.bind(a));return ic(a)}
function kc(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.i+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new bb;cb(a.a,function(){return[lc(this,b),this.g.bind(this)]}.bind(a));return ic(a)}function bc(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new x,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function ic(a){a.a.start();return a.a.g.then(z(a,function(){this.a=null})).catch(z(a,function(a){this.a=null;return Promise.reject(a)}))}
function ec(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new x;return a.f}function lc(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=hc(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new x;return a.f}$b.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};$b.prototype.w=function(){this.f.resolve();this.f=null};function mc(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function nc(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",nc);function oc(){this.j=this.a="";this.u=!1;this.g=this.f=null;this.l=this.i=!1;this.o=this.h="";this.c=null;this.b=[]}
function pc(a){var b=new oc;if(!a)return b;var c=Ba(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=Ba(a,"licenseServerUrl");if(null!=d)b.j=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=Aa(a,"withCredentials","boolean");null!=c&&(b.u=c);c=Ca(a,"licensePostProcessor",Function);null!=c&&(b.f=c);c=Ca(a,"licensePreProcessor",Function);null!=c&&(b.g=c);c=Aa(a,"distinctiveIdentifierRequired","boolean");null!=
c&&(b.i=c);c=Aa(a,"persistentStateRequired","boolean");null!=c&&(b.l=c);c=Ba(a,"audioRobustness");null!=c&&(b.h=c);c=Ba(a,"videoRobustness");null!=c&&(b.o=c);c=Ca(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=Ca(a,"initData",Object)){a=Ca(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=Ba(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function qc(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=pa(c,function(a){return Array.prototype.join.apply(a.initData)+","+a.initDataType})};function rc(a,b,c,d,e,f,g,h,k,m,p){this.g=a;this.j=b;this.u=c;this.a=[];this.h=e||null;this.i=f||null;this.f=g==sc;this.l=h==uc;this.c=k||"";this.o=m||"";this.b=p||null;d&&this.a.push(d)}n("shaka.player.DrmSchemeInfo",rc);var sc=1;rc.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:sc};var uc=1;rc.PersistentState={OPTIONAL:0,REQUIRED:uc};rc.createUnencrypted=function(){return new rc("","",!1,null)};function vc(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}vc.prototype.clone=function(){var a=new vc;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};var wc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function I(a){var b;a instanceof I?(xc(this,a.R),this.$=a.$,this.P=a.P,yc(this,a.fa),this.O=a.O,zc(this,a.a.clone()),this.Y=a.Y):a&&(b=String(a).match(wc))?(xc(this,b[1]||"",!0),this.$=Ac(b[2]||""),this.P=Ac(b[3]||"",!0),yc(this,b[4]),this.O=Ac(b[5]||"",!0),zc(this,b[6]||"",!0),this.Y=Ac(b[7]||"")):this.a=new Bc(null)}l=I.prototype;l.R="";l.$="";l.P="";l.fa=null;l.O="";l.Y="";
l.toString=function(){var a=[],b=this.R;b&&a.push(Cc(b,Dc,!0),":");if(b=this.P){a.push("//");var c=this.$;c&&a.push(Cc(c,Dc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.fa;null!=b&&a.push(":",String(b))}if(b=this.O)this.P&&"/"!=b.charAt(0)&&a.push("/"),a.push(Cc(b,"/"==b.charAt(0)?Ec:Fc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.Y)&&a.push("#",Cc(b,Gc));return a.join("")};
l.resolve=function(a){var b=this.clone();"data"===b.R&&(b=new I);var c=!!a.R;c?xc(b,a.R):c=!!a.$;c?b.$=a.$:c=!!a.P;c?b.P=a.P:c=null!=a.fa;var d=a.O;if(c)yc(b,a.fa);else if(c=!!a.O){if("/"!=d.charAt(0))if(this.P&&!this.O)d="/"+d;else{var e=b.O.lastIndexOf("/");-1!=e&&(d=b.O.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.O=d:c=""!==a.a.toString();c?zc(b,a.a.clone()):c=!!a.Y;c&&(b.Y=a.Y);return b};l.clone=function(){return new I(this)};function xc(a,b,c){a.R=c?Ac(b,!0):b;a.R&&(a.R=a.R.replace(/:$/,""))}function yc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.fa=b}else a.fa=null}function zc(a,b,c){b instanceof Bc?a.a=b:(c||(b=Cc(b,Hc)),a.a=new Bc(b))}
function Ac(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Cc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Ic),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ic(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Dc=/[#\/\?@]/g,Fc=/[\#\?:]/g,Ec=/[\#\?]/g,Hc=/[\#\?@]/g,Gc=/#/g;function Bc(a){this.b=a||null}Bc.prototype.a=null;Bc.prototype.c=null;
function Jc(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Jc(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Bc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Bc.prototype.clone=function(){var a=new Bc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Kc(a,b){this.url=a;this.b=b||new fc;this.g=this.i=this.h=0;this.a=null;this.c=new x;this.f=null}function fc(){this.body=null;this.a=1;this.g=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.i=this.h=!1}function Lc(a){Mc(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Mc(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}l=Kc.prototype;
l.ab=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=sa(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Lc(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Nc(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.g);this.a=new XMLHttpRequest;a=this.url;this.f&&!this.f.supportsCaching()&&(a=new I(a),Jc(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.h;this.a.onload=this.lb.bind(this);this.b.i&&(this.a.onreadystatechange=this.pb.bind(this));this.a.onerror=this.Hb.bind(this);this.a.ontimeout=this.ub.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);return this.c};
function Nc(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new vb;return ob(e).then(function(){return zb(e,c,d)}).then(z(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);F(e);Lc(this);return a})).catch(z(a,function(a){F(e);Lc(this);return Promise.reject(a)}))}function Oc(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Lb=a.a;return b}
l.lb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Lc(this)):this.h<this.b.a?Pc(this):(a=Oc(this,"HTTP error.","net"),this.c.reject(a),Lc(this))};l.pb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(oa=a-Date.now())}};l.Hb=function(){var a=Oc(this,"Network failure.","net");this.c.reject(a);Lc(this)};
l.ub=function(){if(this.h<this.b.a)Pc(this);else{var a=Oc(this,"Request timed out.","net");this.c.reject(a);Lc(this)}};function Pc(a){Mc(a);window.setTimeout(a.ab.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function H(a,b,c,d){this.c=b;this.f=c||0;this.h=null!=d?d:null;this.b=this.a=null;this.i=a}function Qc(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function gc(a,b,c){if(a.a)return a.a;b=b||new fc;if(a.f||a.h)b.b.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=Rc(a,0,b,c);return a.a}H.prototype.g=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Oc(a,"Request aborted.","aborted");a.c.reject(b);Lc(a)}this.b=null}};
function Rc(a,b,c,d){var e=a.c[b].toString();a.i&&(e=a.i(e,c.b)||e);a.b=new Kc(e,c);d&&(a.b.f=d);e=a.b.ab().then(z(a,function(a){this.b=null;return Promise.resolve(a.response)}));return e=e.catch(z(a,function(a){if(this.a&&b+1<this.c.length)return this.a=Rc(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}H.prototype.clone=function(){return new H(this.i,this.c.map(function(a){return a.clone()}),this.f,this.h)};H.prototype.toString=function(){return this.c[0].toString()};function Sc(a,b,c,d,e,f){this.b=new H(null,[new I(a)]);this.a=new fc;this.a.body=b;this.a.method=c;this.a.a=3;this.a.h=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function Tc(a){return gc(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Uc(){this.id=this.url=null;this.type="static";this.c=this.j=this.s=null;this.h=5;this.f=this.b=this.g=null;this.i=1;this.a=[]}function Vc(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function Wc(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.j=[];this.a=[]}function Xc(){this.value=null}function Yc(){this.contentType=this.lang=this.id=null}
function Zc(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function $c(){this.value=this.schemeIdUri=this.b=null;this.children=[];this.a=this.pssh=null}function ad(){this.parsedPssh=this.psshBox=null}function bd(){this.url=null}function cd(){this.url=null}function dd(){this.s=null;this.g=1;this.c=this.b=this.a=this.f=null}
dd.prototype.clone=function(){var a=new dd;a.s=ed(this.s);a.g=this.g;a.f=this.f;a.a=J(this.a);a.b=J(this.b);a.c=J(this.c);return a};function fd(){this.a=this.url=null}fd.prototype.clone=function(){var a=new fd;a.url=ed(this.url);a.a=J(this.a);return a};function gd(){this.a=this.url=null}gd.prototype.clone=function(){var a=new gd;a.url=ed(this.url);a.a=J(this.a);return a};function hd(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}
hd.prototype.clone=function(){var a=new hd;a.s=ed(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=J(this.h);a.a=ed(this.a)||[];a.c=J(this.c);return a};function id(){this.a=this.b=null}id.prototype.clone=function(){var a=new id;a.b=ed(this.b);a.a=J(this.a);return a};function jd(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}jd.prototype.clone=function(){var a=new jd;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=J(this.c);return a};
function kd(){this.a=[]}kd.prototype.clone=function(){var a=new kd;a.a=ed(this.a)||[];return a};function ld(){this.c=this.a=this.b=null}ld.prototype.clone=function(){var a=new ld;a.b=this.b;a.a=this.a;a.c=this.c;return a};function md(a,b){this.na=a;this.end=b}md.prototype.clone=function(){return new md(this.na,this.end)};Uc.TAG_NAME="MPD";Vc.TAG_NAME="Period";Wc.TAG_NAME="AdaptationSet";Xc.TAG_NAME="Role";Yc.TAG_NAME="ContentComponent";Zc.TAG_NAME="Representation";$c.TAG_NAME="ContentProtection";
ad.TAG_NAME="cenc:pssh";bd.TAG_NAME="BaseURL";cd.TAG_NAME="Location";dd.TAG_NAME="SegmentBase";fd.TAG_NAME="RepresentationIndex";gd.TAG_NAME="Initialization";hd.TAG_NAME="SegmentList";id.TAG_NAME="SegmentURL";jd.TAG_NAME="SegmentTemplate";kd.TAG_NAME="SegmentTimeline";ld.TAG_NAME="S";
Uc.prototype.parse=function(a,b){this.url=a.s;this.id=K(b,"id",L);this.type=K(b,"type",L)||"static";this.c=K(b,"mediaPresentationDuration",nd);this.h=K(b,"minBufferTime",nd,this.h);this.g=K(b,"minimumUpdatePeriod",nd,this.g);this.b=K(b,"availabilityStartTime",od,this.b);this.f=K(b,"timeShiftBufferDepth",nd,this.f);this.i=K(b,"suggestedPresentationDelay",nd,this.i);var c=a.s,d=M(this,b,bd);this.s=pd(c,d);if(d=N(this,b,cd))this.j=qd(c,d.url);this.a=M(this,b,Vc)};
Vc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.start=K(b,"start",nd);this.a=K(b,"duration",nd);var c=M(this,b,bd);this.s=pd(a.s,c);this.c=N(this,b,dd);this.f=N(this,b,hd);this.g=N(this,b,jd);this.b=M(this,b,Wc);rd(this)};function rd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
Wc.prototype.parse=function(a,b){var c=N(this,b,Yc)||{},d=N(this,b,Xc);this.id=K(b,"id",L);this.group=K(b,"group",O);this.lang=K(b,"lang",L,c.lang);this.contentType=K(b,"contentType",L,c.contentType);this.width=K(b,"width",P);this.height=K(b,"height",P);this.b=K(b,"mimeType",L);this.i=K(b,"codecs",L);this.c=d&&"main"==d.value;this.lang&&(this.lang=jb(this.lang));c=M(this,b,bd);this.s=pd(a.s,c);this.j=M(this,b,$c);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?sd(this,
b,a.c):N(this,b,dd);this.g=a.f?sd(this,b,a.f):N(this,b,hd);this.h=a.g?sd(this,b,a.g):N(this,b,jd);this.a=M(this,b,Zc);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Xc.prototype.parse=function(a,b){this.value=K(b,"value",L)};Yc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.lang=K(b,"lang",L);this.contentType=K(b,"contentType",L);this.lang&&(this.lang=jb(this.lang))};
Zc.prototype.parse=function(a,b){this.id=K(b,"id",L);this.bandwidth=K(b,"bandwidth",P);this.width=K(b,"width",P,a.width);this.height=K(b,"height",P,a.height);this.f=K(b,"mimeType",L,a.b);this.h=K(b,"codecs",L,a.i);this.lang=a.lang;var c=M(this,b,bd);this.s=pd(a.s,c);this.c=M(this,b,$c);this.g=a.f?sd(this,b,a.f):N(this,b,dd);this.b=a.g?sd(this,b,a.g):N(this,b,hd);this.a=a.h?sd(this,b,a.h):N(this,b,jd);0==this.c.length&&(this.c=a.j)};
$c.prototype.parse=function(a,b){this.b=b;this.schemeIdUri=K(b,"schemeIdUri",L);this.value=K(b,"value",L);var c=K(b,"cenc:default_KID",L);c&&(this.a=c.replace(/[-]/g,""));this.pssh=N(this,b,ad);this.children=Array.prototype.slice.call(b.childNodes)};ad.prototype.parse=function(a,b){var c=td(b);if(c){this.psshBox=va(c);try{this.parsedPssh=new $a(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};bd.prototype.parse=function(a,b){this.url=td(b)};
cd.prototype.parse=function(a,b){this.url=td(b)};dd.prototype.parse=function(a,b){this.s=a.s||this.s;this.g=K(b,"timescale",P,this.g);this.f=K(b,"presentationTimeOffset",O,this.f);this.a=K(b,"indexRange",ud,this.a);this.b=N(this,b,fd)||this.b;this.c=N(this,b,gd)||this.c};fd.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=qd(a.s,c);this.a=K(b,"range",ud,J(a.a))};gd.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=qd(a.s,c);this.a=K(b,"range",ud)};
hd.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=K(b,"timescale",P,this.f);this.g=K(b,"presentationTimeOffset",O,this.g);this.b=K(b,"duration",P,this.b);this.i=K(b,"startNumber",O,this.i);this.h=N(this,b,gd)||this.h;var c=M(this,b,id);this.a=c&&0<c.length?c:this.a;this.c=N(this,b,kd)||this.c};id.prototype.parse=function(a,b){var c=K(b,"media",L);this.b=qd(a.s,c);this.a=K(b,"mediaRange",ud)};
jd.prototype.parse=function(a,b){this.b=K(b,"timescale",P,this.b);this.i=K(b,"presentationTimeOffset",O,this.i);this.a=K(b,"duration",P,this.a);this.j=K(b,"startNumber",O,this.j);this.h=K(b,"media",L,this.h);this.f=K(b,"index",L,this.f);this.g=K(b,"initialization",L,this.g);this.c=N(this,b,kd)||this.c};kd.prototype.parse=function(a,b){this.a=M(this,b,ld)};ld.prototype.parse=function(a,b){this.b=K(b,"t",O);this.a=K(b,"d",O);this.c=K(b,"r",vd)};
function pd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new I(e)):(e=qd(a.slice(0,1),e),c.push(e[0]))}return c}function qd(a,b){if(!b)return a;var c=new I(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function sd(a,b,c){var d=J(c);(b=wd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function N(a,b,c){var d=null;if(b=wd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function wd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function M(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function td(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function ed(a){return a?a.map(function(a){return a.clone()}):null}function J(a){return a?a.clone():null}
function K(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function od(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function nd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=O(b[1]);c&&(a+=31536E3*c);(c=O(b[2]))&&(a+=2592E3*c);(c=O(b[3]))&&(a+=86400*c);(c=O(b[4]))&&(a+=3600*c);(c=O(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function ud(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=O(b[1]);if(null==a)return null;b=O(b[2]);return null==b?null:new md(a,b)}function vd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function P(a){a=window.parseInt(a,10);return 0<a?a:null}function O(a){a=window.parseInt(a,10);return 0<=a?a:null}function L(a){return a};function xd(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,k=(h-1)*e.a,m=k/e.b,k=(k+e.a)/e.b,h=yd(a,b,h-1+e.j,(h-1)*e.a);if(!h)return null;f.push(new Q(m,k,h))}return f}function yd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new H(a,b.s,0,null):null;c=zd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Qc(b.s,c);return new H(a,b,0,null)}
function zd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new I(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Ad(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].b,f=null!=f?f:d,g=a[e].c||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].b+b-f)/g)-1:Math.ceil((a[e+1].b-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Bd(a,b){this.a=new fc;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.i=!0;this.b=a}function Cd(a){var b=a.b;return gc(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?N({s:d},a,Uc):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="mpd";return Promise.reject(d)})};function Q(a,b,c){this.b=a;this.a=b;this.url=c}function hc(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function Dd(a,b){return a.map(function(a){return new Q(a.b+b,null!=a.a?a.a+b:null,a.url)})};function Ed(){}
Ed.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new ea(b);if(440786851!=w(g).id)f=null;else{var h=w(g);if(408125543!=h.id)f=null;else{var k=h.a.byteOffset,m;var p=new ea(h.a);for(b=null;Ua(p.a);){var t=w(p);if(357149030==t.id){b=t;break}}if(b){for(var y=new ea(b.a),p=1E6;Ua(y.a);){var u=w(y);if(2807729==u.id){p=ma(u);break}}m=p/1E9}else m=null;f=m?{Db:k,Ib:m}:null}}if(f){var v=w(new ea(a));if(475249515!=v.id)e=null;else{var ta=f.Db,Eb=f.Ib;a=[];var Kd=new ea(v.a);for(f=v=-1;Ua(Kd.a);){var Ld=
w(Kd);if(187==Ld.id){var Ga;var Md=new ea(Ld.a),Nd=w(Md);if(179!=Nd.id)Ga=null;else{var $e=ma(Nd),Od=w(Md);if(183!=Od.id)Ga=null;else{for(var Pd=new ea(Od.a),k=0;Ua(Pd.a);){var Qd=w(Pd);if(241==Qd.id){k=ma(Qd);break}}Ga={Kb:$e,Cb:k}}}if(Ga){var Rd=Eb*Ga.Kb,Sd=ta+Ga.Cb;if(0<=v){var tc=new H(d,c,f,Sd-1);a.push(new Q(v,Rd,tc))}v=Rd;f=Sd}}}0<=v&&(tc=new H(d,c,f,null),a.push(new Q(v,null,tc)));e=a}}else e=null}catch(Td){if(!(Td instanceof RangeError))throw Td;}return e};function R(a){this.v=a;this.g=0}R.prototype.destroy=function(){this.v=null};l=R.prototype;l.length=function(){return this.v.length};function S(a){if(0==a.v.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.v[0]}function T(a){if(0==a.v.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.v[a.v.length-1]}l.get=function(a){if(0>a||a>=this.v.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.v[a]};
l.ia=function(a){a=hc(this.v,a);return 0<=a?this.v[a]:null};l.Ba=function(a){Fd(this,a);return!0};
function Fd(a,b){a.g!=b.g&&(b=new R(Dd(b.v,a.g-b.g)));if(0==a.length())a.v=b.v.slice(0);else if(0!=b.length()&&null!=T(a).a&&!(null!=T(b).a&&T(b).a<T(a).a)){if(T(a).a<=S(b).b){var c,d=T(a);c=T(a).b;var e=S(b).b;c=new Q(c,e,d.url);d=a.v.slice(0,-1).concat([c])}else{for(d=0;d<a.v.length&&!(a.v[d].a>=S(b).b);++d);a.v[d].b<S(b).b?(c=S(b).b,c=new Q(a.v[d].b,c,a.v[d].url),d=a.v.slice(0,d).concat([c])):(S(a).b>S(b).b||S(b),d=a.v.slice(0,d))}a.v=d.concat(b.v)}}
l.ha=function(a){var b=a-this.g;if(0==b)return 0;this.v=Dd(this.v,b);this.g=a;return b};l.Aa=function(){return 0<this.length()?{start:S(this).b,end:T(this).a}:{start:0,end:0}};function U(a,b,c,d){R.call(this,a);this.f=b;this.u=c;this.l=d;this.c=this.j=this.a=null;Gd(this)}q(U,R);U.prototype.destroy=function(){this.u=this.f=null;R.prototype.destroy.call(this)};U.prototype.ia=function(a){Hd(this,na()/1E3);return R.prototype.ia.call(this,a)};U.prototype.Ba=function(a){Fd(this,a);null==this.a&&Gd(this);return!0};
function Gd(a){if(0!=a.length()){a.length();var b=null!=T(a).a?T(a).a:T(a).b;if(a.f.b>a.l)a.a=b;else{var c=a.l-(a.f.b+a.u.start);0>c?a.a=b:c<Math.max(T(a).b,T(a).a||0)?(T(a),a.a=b):a.a=c}a.j=T(a).b;a.c=S(a).b}}U.prototype.ha=function(a){a=R.prototype.ha.call(this,a);null!=this.a&&(this.j+=a,this.c+=a,this.j>this.a&&(this.a+=a));return a};U.prototype.Aa=function(){return Id(this,na()/1E3)};
function Id(a,b){Hd(a,b);if(null==a.a||null==a.j||null==a.c)return{start:0,end:0};var c=b-a.l,d=a.a+c;null!=a.f.f&&(d=d-a.c-a.f.f,0<d&&(a.c+=d));c=a.j+c;c=0<a.length()?null!=T(a).a?Math.min(c,T(a).a):c:a.c;c=Math.max(c,a.c);return{start:a.c,end:c}}function Hd(a,b){if(null!=a.f.f)if(null==a.a)a.length();else{for(var c=a.a+(b-a.l),d=0,e=0;e<a.v.length;++e){var f=null;e<a.v.length-1?f=a.v[e+1].a:(f=a.v[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.f.f)++d;else break}0<d&&a.v.splice(0,d)}};function Jd(a,b,c,d,e){var f=1,g=0,h;if(a.b>d)h=null;else{var k=a.i||0,m=a.f||0;h=c.a;h=h.a/h.b;var p=d-(a.b+b.start);0>p?h=null:(m=p-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,p-=h,0>p?h=null:(k=Math.floor(p/h)*h-k,0>k&&(k=0),k=Math.floor(k/h)*h,h={Ma:m/h+1,current:(k>=m?k:m)/h+1}))}h&&(f=h.Ma,g=h.current-h.Ma+1);f=xd(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;U.call(this,f,a,b,d);this.o=c;this.i=this.b=0<this.length()?a.b+b.start+T(this).a:null;this.h=
h?h.current+1:null;this.w=e}q(Jd,U);Jd.prototype.destroy=function(){this.w=this.o=null;U.prototype.destroy.call(this)};Jd.prototype.ia=function(a){var b=na()/1E3;Ud(this,b);Hd(this,b);return R.prototype.ia.call(this,a)};Jd.prototype.Ba=function(a){if(null!=this.b||!(a instanceof Jd)||null==a.b)return!1;this.b=a.b;this.i=a.i;this.h=a.h;Fd(this,a);Ud(this,na()/1E3);Gd(this);return!0};Jd.prototype.ha=function(a){a=U.prototype.ha.call(this,a);null!=this.b&&(this.b+=a,this.i+=a);return a};
Jd.prototype.Aa=function(){var a=na()/1E3;Ud(this,a);return Id(this,a)};function Ud(a,b){if(null!=a.b&&null!=a.i&&null!=a.h){var c=a.o.a,c=c.a/c.b,d=Math.floor((a.i+(b-a.l)-a.b)/c);if(0!=d){var e=xd(a.w,a.o,a.h,d);Array.prototype.push.apply(a.v,Dd(e,a.g));a.b+=d*c;a.h+=d}}};function Vd(){}
Vd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new fa(a),h=A(g);if(1936286840!=A(g))e=null;else{1==h&&(h=Va(g));var k=la(g);ja(g,3);ja(g,4);var m=A(g);if(0==m)e=null;else{var p,t;0==k?(p=A(g),t=A(g)):(p=Va(g),t=Va(g));ja(g,2);var y=g.b.getUint16(g.a,g.c);g.a+=2;a=p;b=b+h+t;for(h=0;h<y;h++){var u=A(g);t=(u&2147483648)>>>31;var k=u&2147483647,v=A(g);A(g);if(1==t){e=null;break a}var ta=new H(d,c,b,b+k-1);f.push(new Q(a/m,(a+v)/m,ta));a+=v;b+=k}e=f}}}}catch(Eb){if(!(Eb instanceof RangeError))throw Eb;
}return e};function Wd(a,b,c,d,e){this.c=a;this.g=b;this.b=c;this.h=d;this.a=null;this.f=e}Wd.prototype.destroy=function(){this.f=this.b=this.g=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Wd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.c.type)try{this.a=new Jd(this.c,this.g,this.b,this.h,this.f)}catch(a){return Promise.reject(a)}else{var b=this.b.a,b=xd(this.f,this.b,1,Math.ceil(this.g.a/(b.a/b.b)));if(!b)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b);this.a=new R(b)}return Promise.resolve(this.a)};function Xd(a,b,c,d,e,f,g){this.g=a;this.j=b;this.f=c;this.a=d;this.c=e;this.l=f;this.i=this.b=null;this.h=g}Xd.prototype.destroy=function(){this.h=this.j=this.g=null;this.a.g();this.a=null;this.c&&(this.c.g(),this.c=null);this.i&&(this.i.destroy(),this.i=null);this.b=null};
Xd.prototype.create=function(){if(this.b)return this.b;var a=[gc(this.a)];"webm"==this.f&&a.push(gc(this.c));return this.b=Promise.all(a).then(z(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Vd,d=d.parse(new DataView(c),this.a.f,this.a.c,this.h)):"webm"==this.f&&(d=new Ed,d=d.parse(new DataView(c),new DataView(a),this.a.c,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new U(d,this.g,this.j,this.l):e=new R(d);return Promise.resolve(e)}))};function Yd(a,b,c,d,e){this.b=a;this.c=b;this.f=c;this.h=d;this.a=null;this.g=e}Yd.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Yd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=Ad(a.c,a.b||1,this.c.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=yd(this.g,this.f,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.b;c.push(new Q(f-h,g-h,e))}"dynamic"==this.b.type?this.a=new U(c,this.b,this.c,this.h):this.a=new R(c);return Promise.resolve(this.a)};function Zd(a,b,c,d,e){this.c=a;this.b=b;this.g=c;this.a=null;this.h=d;this.f=e}Zd.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Zd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c&&(b=Ad(a.c,a.f||1,this.b.a||0));var c=0;a.b&&a.i?c=a.b*a.i:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,k=null,m=null;a.b?(k=c+a.b,m=k/a.f):0<b.length?(k=b[f].end-(a.g||0),m=k/a.f):(m=h+this.b.a,k=m*a.f);var c=k,k=0,p=null;g.a&&(k=g.a.na,p=g.a.end);e.push(new Q(h,m,new H(this.f,g.b,
k,p)))}"dynamic"==this.c.type?this.a=new U(e,this.c,this.b,this.h):this.a=new R(e);return Promise.resolve(this.a)};function $d(a){this.b=a;this.a=null}$d.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};$d.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new Q(c.start_time,c.end_time,new H(null,[new I(c.url)],c.start_byte,null)))}this.b=null;this.a=new R(a);return Promise.resolve(this.a)};function ae(a){this.b=a;this.a=null}ae.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};ae.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new Q(0,null,this.b);this.a=new R([a]);return Promise.resolve(this.a)};function be(a){this.a=a}be.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)};be.prototype.create=function(){return this.a?gc(this.a):Promise.resolve(null)};function ce(){this.B=de++;this.id=this.C=this.F=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.L=!1;this.J=!0}var de=0;ce.prototype.destroy=function(){this.F&&(this.F.destroy(),this.F=null);this.C&&(this.C.destroy(),this.C=null)};function ee(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function fe(){this.B=ge++;this.id=null;this.contentType=this.lang="";this.b=!1;this.m=[];this.a=[]}var ge=0;
fe.prototype.destroy=function(){for(var a=0;a<this.m.length;++a)this.m[a].destroy();this.a=this.m=null};function he(a){for(var b=[],c=0;c<a.a.length;++c){var d=new ie;d.id=a.B;d.a=a.a[c];d.contentType=a.contentType;d.b=a.m.length?ee(a.m[0]):"";b.push(d)}return b}function je(){this.id=null;this.start=0;this.b=null;this.a=[]}je.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ke(){this.b=!1;this.g=this.f=null;this.c=0;this.a=[]}
ke.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ie(){this.id=0;this.a=null;this.b=this.contentType=""};function le(a,b){nb.call(this,"readwrite",b);this.l=a;this.b=0}q(le,nb);
function me(a,b,c,d,e){for(var f=[],g=[],h=0,k=0,m=[],p=b.map(function(a){return a.F.create()}),p=Promise.all(p),t=b.map(function(a){return a.C.create()}),t=Promise.all(t),p=Promise.all([p,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)p=p.then(function(a){return ne(this,b[a],f[a],g[a],h,k)}.bind(a,t)),p=p.then(function(a,b){k+=f[a].length();m.push(b)}.bind(a,t));return p.then(z(a,function(){return oe(tb(this))})).then(z(a,function(a){var b=
new x;c=pa(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a},g=tb(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function pe(a,b){return ub(tb(a),b).then(z(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(qe(this,a.stream_ids[e]));a=tb(this);d.push(a.delete(b));return Promise.all(d)}))}
function ne(a,b,c,d,e,f){var g=[oe(sb(a)),oe(qb(a).index("stream"))],g=Promise.all(g).then(z(a,function(a){return{qa:Math.max(a[0],a[1]),ga:new ArrayBuffer(0),Ca:0,v:[],ya:null,Jb:e,Ta:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function oe(a){var b=new x,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
le.prototype.g=function(a,b,c){var d=new x;a={stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.v};var e=sb(this).put(a);e.onsuccess=function(){d.resolve(c.qa)};e.onerror=function(){d.reject(e.error)};return d};le.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.j.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(z(this,function(a){qe(this,b.qa);return Promise.reject(a)}))};
le.prototype.c=function(a,b,c,d){var e=new x;0==b.ga.byteLength&&(b.ya=a);b.ga=re(b.ga,d);b.Ta++;var f=D({type:"progress",detail:b.Ta/b.Jb*100,bubbles:!0});if(1048576<=b.ga.byteLength||c){c={stream_id:b.qa,segment_id:b.Ca,content:b.ga};var g=qb(this).put(c);b.v.push({start_time:b.ya.b,start_byte:b.ya.url.f,end_time:a.a,url:"idb://"+b.qa+"/"+b.Ca});b.Ca++;b.ga=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=z(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function re(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}le.prototype.j=function(a){var b=new fc;b.c=1E3*this.b;return gc(a.url,b,this.l)};
function qe(a,b){var c=new x,d=sb(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=qb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function se(a){this.a=a}
function te(a,b,c){for(var d=na()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var k=0;k<h.a.length;++k){var m=h.a[k],p=0,p=p+(m.g?1:0),p=p+(m.b?1:0),p=p+(m.a?1:0);0==p?(h.a.splice(k,1),--k):1!=p&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}ue(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){k=h=f.b[g];m=null;for(p=0;p<k.a.length;++p){var t=k.a[p].f||"";m?t!=m&&(k.a.splice(p,1),--p):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.b&&(b.b=d);e=new ke;"dynamic"==b.type&&(e.b=!0,e.f=b.g,e.g=new H(c,b.j||b.url));e.c=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=ve(a,b,g,d,c);e.a.push(g)}return e}
function ue(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null);b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.c};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.c)||(e=a.a[a.a.length-1],d?a.c=c:b(e.start)&&b(e.a)?a.c=e.start+e.a:"dynamic"!=a.type&&
(a.c=c))}}function ve(a,b,c,d,e){var f=new je;f.id=c.id;f.start=c.start;f.b=c.a;var g=new r;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=da(g),k=0;k<h.length;++k){var m=new r;g.get(h[k]).forEach(function(a){m.push(a.group,a)});for(var p=da(m),t=0;t<p.length;++t){var y=new r;m.get(p[t]).forEach(function(a){y.push(a.lang,a)});for(var u=da(y),v=0;v<u.length;++v){var ta=y.get(u[v]),ta=we(a,b,c,ta,d,e);f.a.push(ta)}}}return f}
function we(a,b,c,d,e,f){Ra(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new fe,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},k=0;k<d.length;++k)for(var m=d[k],p=0;p<m.a.length;++p){var t=m.a[p],y=xe(a,t),u=g.a.slice(0);
ye(y,u);0==u.length&&0<g.a.length||!(t=ze(b,c,t,e,f))||(g.m.push(t),g.a=u,h[t.B]=m)}if(g.a.some(function(a){return""==a.a}))return g.m.forEach(function(a){a.L=!0}),g;a=Ae(d);for(k=0;k<g.m.length;++k)t=g.m[k],m=h[t.B],m==a&&(t.L=!0);return g}function Ae(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function ye(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.j==g.j&&f.u==g.u&&f.f==g.f&&f.g==g.g&&f.i==g.i&&f.l==g.l&&f.h==g.h&&f.o==g.o&&ia(f.c,g.c)){d=!0;break}}d||(b.splice(c,1),--c)}}function xe(a,b){var c=[];if(0==b.c.length)c.push(new oc);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Be(a,b.c[d]));return c}
function Be(a,b){var c=[];if(2==a.a.length){var d=a.a(b.schemeIdUri,b.b);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=pc(d[e]);0==f.b.length&&b.pssh&&b.pssh.psshBox&&qc(f,[{initData:b.pssh.psshBox,initDataType:"cenc"}]);c.push(f)}}else{d=a.a(b);if(!(d&&d instanceof rc))return[];e=new oc;e.a=d.g;e.j=d.j;e.u=d.u;e.f=d.h;e.g=d.i;e.i=d.f;e.l=d.l;e.h=d.c;e.o=d.o;e.c=d.b?new Uint8Array(d.b.buffer):null;qc(e,d.a);c.push(e)}return c}
function ze(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new fd,h.url=c.s,h.a=g.a?g.a.clone():null),h=Ce(h,e),g=g.c?Ce(g.c,e):null,a=new Xd(a,b,f,h,g,d,e),b=new be(g),d=new ce,d.F=a,d.C=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?Ce(f.h,e):null,a=new Zd(a,b,c,d,e),b=
new be(f),d=new ce,d.F=a,d.C=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.a?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.a=null):f.c&&(f.a=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?De(c,f,gd):null,!g)){f=null;break a}f=g?Ce(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?yd(e,c,1,0)?(h=(h=c.a.f)?De(c,h,fd):null)?(h=Ce(h,e),a=new Xd(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new Yd(a,b,c,d,e):g.a?"dynamic"!=a.type&&null==b.a?null:
new Wd(a,b,c,d,e):null:null;a?(b=new be(f),d=new ce,d.F=a,d.C=b,f=d):f=null}else f=null;g=c.a.b;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new ce,f.F=new ae(new H(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.a&&f.f.push(b.a);return f}function De(a,b,c){b=zd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Qc(a.s,b);return c}
function Ce(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.na,e=a.a.end);return new H(b,c,d,e)};function Ee(a,b,c){C.call(this,a);this.f=b;this.b=c;this.a=this.g=null;this.l=new Xa;this.j={};this.h=[];this.w=0;this.c=new x;this.o=null;this.u=0}q(Ee,C);Ee.prototype.destroy=function(){this.i=null;for(var a=0;a<this.h.length;++a)this.h[a].close().catch(function(){});this.h=[];this.j=this.a=this.g=null;this.c.destroy();this.c=null;this.l.destroy();this.f=this.b=this.l=null};
Ee.prototype.initialize=function(){for(var a=new r,b=this.b.Na(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!Fe(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.i?"required":"optional",persistentState:h.l||this.b.ea()?"required":"optional",sessionTypes:[this.b.ea()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var k;"audio"==f.contentType?k=f.a.h:"video"==f.contentType&&(k=f.a.o);h[g].push({contentType:f.b,robustness:k})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Da(a),this.c.resolve(),Promise.resolve();k=new x;c=Ge(this,c,k);c=c.then(this.hb.bind(this,b,a));c=c.then(this.Eb.bind(this));k.reject(null);return c};
function He(a,b){null==a.o&&(a.o=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function Ge(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.ea()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}l=Ee.prototype;
l.hb=function(a,b,c){if(!this.f)return Ie();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var k=e[h+"Capabilities"];if(k&&k.length){for(var k=k[0],m=[],p={},t=0;t<a.length;++t){var y=a[t];if(y.a.a==d&&y.b==k.contentType&&!(y.id in p)){m.push(y);p[y.id]=!0;var u;if(this.a){u=this.a;var y=y.a,v=new oc;v.a=u.a;v.j=u.j;v.u=u.u;v.f=u.f;v.g=u.g;v.i=u.i;v.l=u.l;v.h=u.h;v.o=u.o;v.c=u.c?new Uint8Array(u.c.buffer):null;qc(v,u.b);qc(v,
y.b);u=v}else u=y.a;this.a=u}}b.a[h]=m}}}this.b.Da(b);return c.createMediaKeys()};
l.Eb=function(a){if(!this.f)return Ie();this.g=a;return this.f.setMediaKeys(this.g).then(z(this,function(){return this.f?this.a.c?this.g.setServerCertificate(this.a.c):Promise.resolve():Ie()})).then(z(this,function(){if(!this.f)return Ie();if(0<this.b.va().length)Je(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.Qa({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&B(this.l,this.f,"encrypted",this.Qa.bind(this))}}))};
function Ie(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}l.Qa=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.j[c]){try{var d=Ke(this)}catch(e){d=E(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.j[c]=!0;a.catch(z(this,function(a){if(this.j){this.j[c]=!1;var b=E(a);this.dispatchEvent(b);this.c.reject(a)}}));this.h.push(d)}};
function Je(a){for(var b=a.b.va(),c=0;c<b.length;++c){var d=Ke(a),e=d.load(b[c]);a.h.push(d);e.catch(z(a,function(a){a=E(a);this.dispatchEvent(a)}))}}function Ke(a){var b=null;if(a.b.ea())try{b=a.g.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.g.createSession();B(a.l,b,"message",a.sb.bind(a));B(a.l,b,"keystatuseschange",a.kb.bind(a));return b}l.sb=function(a){Le(this,a.target,this.a,a.message)};
l.kb=function(a){a=a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d=c.next()){var e=wa(new Uint8Array(d.value)),d=a.get(d.value);b[e]=d}this.b.Ra(b)};
function Le(a,b,c,d){d=Me(c,d);Tc(new Sc(d.url,d.body,d.method,c.u,d.headers,a.u)).then(z(a,function(a){c.f&&(a=c.f(a));return b.update(a)})).then(z(a,function(){var a=D({type:"sessionReady",detail:b});this.dispatchEvent(a);this.w++;this.w>=this.h.length&&this.c.resolve()})).catch(z(a,function(a){a.Nb=b;a=E(a);this.dispatchEvent(a)}))}
function Me(a,b){var c={url:a.j,body:b.slice(0),method:"POST",headers:{}};if(!a.g)return c;a.g(c);c.url=Ba(c,"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=Ba(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=Ca(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c};function Ne(a,b,c,d,e){C.call(this,a);this.c=b;this.a=new $b(c,d,e);this.A=this.D=this.b=null;this.I=!1;this.g=null;this.o=!1;this.j=null;this.u=!1;this.h=new x;this.l=this.f=!1;this.K=0;this.w=15;this.G=!1}q(Ne,C);Ne.prototype.H=function(a){null!=a.initialStreamBufferSize&&(this.K=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.w=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.o=Number(a.segmentRequestTimeout))};
Ne.prototype.destroy=function(){Oe(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.i=this.c=this.a=null};l=Ne.prototype;l.oa=function(){return this.b};l.Oa=function(){return this.D};l.bb=function(a){this.f||a.then(function(){this.f=!0;this.g||Pe(this,0)}.bind(this)).catch(function(){});return this.h};l.Pa=function(){return this.l};
l.ra=function(a,b,c){if(a!=this.b){var d=[a.F.create(),a.C.create()];Promise.all(d).then(z(this,function(d){if(this.c){var f=this.b;this.b=a;this.D=d[0];this.A=d[1];this.I=!0;this.o||(f?b&&Qe(this,!0,c):Pe(this,0))}})).catch(z(this,function(a){"aborted"!=a.type&&(this.f?(a=E(a),this.dispatchEvent(a)):this.h.reject(a))}))}};l.Ua=function(){return Qe(this,!1)};
function Qe(a,b,c){a.b&&!a.o&&(a.o=!0,Oe(a),bc(a.a).then(z(a,function(){var a=this.c.currentTime;if(!b&&0<cc(this.a,a)&&0<=hc(this.a.b,a))return Promise.resolve();if(c)return kc(this.a,this.c.currentTime+c);this.G=!0;return jc(this.a)})).then(z(a,function(){this.o=!1;Pe(this,0)})).catch(z(a,function(a){this.o=!1;this.f?(a=E(a),this.dispatchEvent(a)):this.h.reject(a)})))}l.wa=function(){};l.za=function(){return!0};l.Ea=function(){return this.u?this.w:Math.min(this.K,this.w)};
l.xb=function(){if(this.u&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.l)a=1<this.a.c.buffered.length?!0:!1;if(a)Qe(this,!0);else{this.g=null;a=this.b;var b=this.D,c=this.c.currentTime;cc(this.a,this.u?c:c+(this.j||0))>=this.Ea()?(Re(this),Pe(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Se(this,c,b))?(b=dc(this.a,b,a.c,this.A),this.A=null,this.I&&(this.I=!1,Te(this,a)),this.l=!1,b.then(z(this,function(a){null==this.j&&(this.j=a);this.G&&0<cc(this.a,c)&&(this.G=!1,this.c.currentTime+=.001);
Pe(this,0)})).catch(z(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Lb.status)&&this.b&&Pe(this,5E3);a=E(a);this.dispatchEvent(a)}}))):(Re(this),this.f&&!this.l&&(this.l=!0,Ue(this)),Pe(this,1E3))}}};function Se(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.ia(a.a):null:c.ia(b)||(c.length()?T(c):null)}function Re(a){if(!a.u&&null!=a.j){a.u=!0;var b=a.a,c=a.j,d=c-b.u;0!=d&&(b.b=Dd(b.b,d),b.u=c);a.h.resolve(a.j)}}
function Te(a,b){var c;c=b.a.split("/")[0];c=D({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Ue(a){var b=D({type:"ended"});a.dispatchEvent(b)}function Pe(a,b){a.g=window.setTimeout(a.xb.bind(a),b)}function Oe(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function Ve(a,b){C.call(this,a);this.b=b;this.h=!0;this.g=this.f=null;this.c=new x;this.a=null}q(Ve,C);Ve.prototype.H=function(){};Ve.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.i=this.b=this.f=this.g=this.a=this.c=null};l=Ve.prototype;l.oa=function(){return this.f};l.Oa=function(){return this.g};l.bb=function(){return this.c};l.Pa=function(){return!0};
l.ra=function(a){a.F.create().then(z(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.g=b;b=S(b).url.c[0].toString();var d=this.za();this.a&&(this.wa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.wa(d);b=D({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};l.Ua=function(){};
l.wa=function(a){this.h=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};l.za=function(){return this.h};l.Ea=function(){return 0};function We(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Xe(a,b){var c=new Ye(b);a.streamHistory.push(new Ze(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function Ye(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function Ze(a){this.timestamp=na()/1E3;this.value=a};function V(a){C.call(this,null);this.a=a;this.b=null;this.f=new Xa;this.l=this.o=null;this.H=0;this.A=null;this.j=!1;this.g=new We;this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new vc};this.u=1;this.D=null}q(V,C);n("shaka.player.Player",V);V.version="";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function Fe(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=Fe;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+Wb(a)+" }",0)};V.prototype.destroy=function(){return this.w().then(z(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.w=function(){if(!this.b)return Promise.resolve();this.j&&af(this);this.a.pause();Ya(this.f);bf(this);cf(this);this.o&&(this.o.destroy(),this.o=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.j=!1;this.g=new We;return a};V.prototype.unload=V.prototype.w;
V.prototype.ma=function(a){var b=this.w();this.a.autoplay&&(Ma("load"),B(this.f,this.a,"timeupdate",this.jb.bind(this)));a.D(this.c);a.Za(this.D);this.D=null;b=b.then(z(this,function(){return a.Z()}));b.catch(z(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(z(this,function(){if(!this.a)return df();this.b=a;B(this.f,this.b,"seekrangechanged",this.qb.bind(this));this.o=new Ee(this,this.a,this.b);return this.o.initialize()})).then(z(this,function(){if(!this.a)return df();B(this.f,
this.a,"error",this.Fb.bind(this));B(this.f,this.a,"playing",this.ob.bind(this));B(this.f,this.a,"pause",this.nb.bind(this));return this.b.Ja(this,this.a)})).then(z(this,function(){if(!this.a)return df();ef(this)})).catch(z(this,function(a){if(!this.a)return df();if("destroy"!=a.type){var b=E(a);this.dispatchEvent(b)}return this.w().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.ma;
function df(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}l=V.prototype;l.jb=function(){Pa("load");this.g.playbackLatency=Qa("load")/1E3;this.f.sa(this.a,"timeupdate")};l.Fb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(ff[a]||"Unknown playback error."),a.type="playback",a=E(a),this.dispatchEvent(a))}};
l.ob=function(){Ma("playing");!this.l&&0>this.u&&(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),this.u));this.j&&af(this)};l.nb=function(){Pa("playing");var a=Qa("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}cf(this)};l.qb=function(a){this.H=a.start};
l.$a=function(){if(!this.a.paused){Pa("playing");var a=Qa("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;Ma("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.$a;V.prototype.la=function(){return this.b?this.b.ja():[]};V.prototype.getVideoTracks=V.prototype.la;V.prototype.da=function(){return this.b?this.b.pa():[]};
V.prototype.getAudioTracks=V.prototype.da;V.prototype.ka=function(){return this.b?this.b.Ga():[]};V.prototype.getTextTracks=V.prototype.ka;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.eb=function(a,b){return this.b?this.b.Xa(a,void 0==b?!0:b):!1};V.prototype.selectAudioTrack=V.prototype.eb;V.prototype.fb=function(a){return this.b?this.b.Ya(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.fb;V.prototype.X=function(a){this.b&&this.b.Fa(a)};V.prototype.enableTextTrack=V.prototype.X;V.prototype.K=function(a){this.h({enableAdaptation:a})};V.prototype.enableAdaptation=V.prototype.K;V.prototype.S=function(){return this.c.enableAdaptation};V.prototype.getAdaptationEnabled=V.prototype.S;V.prototype.ta=function(a){this.h({streamBufferSize:a})};V.prototype.setStreamBufferSize=V.prototype.ta;V.prototype.V=function(){return Number(this.c.streamBufferSize)};
V.prototype.getStreamBufferSize=V.prototype.V;V.prototype.gb=function(a){this.h({licenseRequestTimeout:a/1E3})};V.prototype.setLicenseRequestTimeout=V.prototype.gb;V.prototype.aa=function(a){this.h({mpdRequestTimeout:a/1E3})};V.prototype.setMpdRequestTimeout=V.prototype.aa;V.prototype.N=function(a){this.h({segmentRequestTimeout:a/1E3})};V.prototype.setRangeRequestTimeout=V.prototype.N;V.prototype.M=function(a){this.h({preferredLanguage:a})};V.prototype.setPreferredLanguage=V.prototype.M;
V.prototype.ba=function(a){cf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.G(this.a.currentTime,Date.now(),a));this.u=a};V.prototype.setPlaybackRate=V.prototype.ba;V.prototype.T=function(){return this.u};V.prototype.getPlaybackRate=V.prototype.T;V.prototype.ca=function(a){this.h({restrictions:a})};V.prototype.setRestrictions=V.prototype.ca;V.prototype.U=function(){return this.c.restrictions.clone()};V.prototype.getRestrictions=V.prototype.U;
V.prototype.cb=function(a){this.D=a};V.prototype.setPlaybackStartTime=V.prototype.cb;V.prototype.I=function(){return this.b?this.b.Wa():!1};V.prototype.isLive=V.prototype.I;
V.prototype.h=function(a){if(a){var b=Aa(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=za(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=za(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=za(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=za(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=Ba(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=b);a=Ca(a,"restrictions",vc);null!=a&&(this.c.restrictions=
a.clone());this.b&&this.b.D(this.c)}};V.prototype.configure=V.prototype.h;V.prototype.ua=function(){return this.c};V.prototype.getConfiguration=V.prototype.ua;function cf(a){a.l&&(window.clearTimeout(a.l),a.l=null)}function ef(a){bf(a);a.A=window.setTimeout(a.W.bind(a),100)}function bf(a){a.A&&(window.clearTimeout(a.A),a.A=null)}
V.prototype.G=function(a,b,c){this.l=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.H+(this.I()?1:.05)?this.a.pause():(d=Math.max(this.H,a+d),this.a.currentTime=d,this.l=window.setTimeout(this.G.bind(this,a,b,c),250))};function af(a){Pa("buffering");var b=a.g;b.bufferingTime+=Qa("buffering")/1E3;a.j=!1;a.dispatchEvent(D({type:"bufferingEnd"}))}
V.prototype.W=function(){ef(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0);if(this.j)b=this.b.Va(),a>b&&(af(this),this.a.play());else{var c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;!this.a.paused&&!b&&.2>a&&(this.j=!0,this.a.pause(),this.g.bufferingHistory.push(na()/1E3),Ma("buffering"),this.dispatchEvent(D({type:"bufferingStart"})))}}};
var ff={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function gf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.m.length;++g)Fe(ee(f.m[g]))||(f.m.splice(g,1),--g);0==e.m.length&&(c.a.splice(d,1),--d)}}function hf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].m.sort(jf)}function jf(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function kf(a){this.a=a}kf.prototype.destroy=function(){this.a.destroy();this.a=null};function lf(a,b){var c=mf(b),d=mf(a.a);return Promise.all([c,d]).then(z(a,function(a){var c=a[0];a=a[1];var d=this.a.a;gf(d);hf(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];nf(b,this.a,c,a,d);c=b.a;gf(c);hf(c);return Promise.resolve(d)}))}
function mf(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.m}).reduce(b,[]);a=c.map(function(a){return a.F.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].B]=a[f];return Promise.resolve(b)})}
function nf(a,b,c,d,e){var f=new r;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=da(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(of(k[0],h[0],c,d,e),k[0].b=h[0].b)}}
function of(a,b,c,d,e){var f=new r;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=da(f);for(b=0;b<a.length;++b){var h=a[b],k=f.get(h);1<k.length||(h=g.get(h))&&0!=h.length&&1==h.length&&pf(k[0],h[0],c,d,e)}}
function pf(a,b,c,d,e){var f=new r;a.m.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.m.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=da(f),k=0;k<h.length;++k){var m=h[k];b[m]=m;var p=f.get(m);1<p.length||((m=g.get(m))&&0!=m.length?1==m.length&&(qf(p[0],m[0],c,d),p[0].C=m[0].C,m[0].C=null,p[0].c=m[0].c):(e.push(p[0]),a.m.splice(a.m.indexOf(p[0]),1)))}h=da(g);for(k=0;k<h.length;++k)m=h[k],b[m]||(b[m]=m,m=g.get(m),a.m.push(m[0]))}
function qf(a,b,c,d){a=c[a.B];b=d[b.B];a.length();a.Ba(b)&&a.length()};function W(){this.a=this.b=null;this.f=new Xa;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}n("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,B(this.f,this.b,"bandwidth",this.l.bind(this)),B(this.f,this.a,"adaptation",this.j.bind(this)),B(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=rf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.l=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=rf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function rf(a){var b=a.a.ja();if(0==b.length)return null;b.sort(nc);var c;a:{c=a.a.pa();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function sf(a,b,c){C.call(this,null);this.f=a;this.c=b;this.b=pc(c);this.a=null}q(sf,C);n("shaka.player.HttpVideoSource",sf);sf.prototype.D=function(){};sf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.i=this.b=null};l=sf.prototype;l.Ja=function(a,b){this.i=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};l.Z=function(){return Promise.resolve()};
l.ja=function(){return[]};l.pa=function(){return[]};l.Ga=function(){return[]};l.Va=function(){return 5};l.Na=function(){var a=new ie;a.a=this.b;return[a]};l.Da=function(){};sf.prototype.selectVideoTrack=function(){return!1};l=sf.prototype;l.Xa=function(){return!1};l.Ya=function(){return!1};l.Fa=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};l.Za=function(){};l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return!1};
l.Ra=function(a){for(var b in a){var c=xa[a[b]]||null;c&&(c=Error("Key"+b+"is not usable. "+c),c.type="drm",c=E(c),this.dispatchEvent(c))}};function X(a,b,c){C.call(this,null);this.a=a;this.U=b;this.l=new Xa;this.g=new MediaSource;this.f=null;this.aa=0;this.b=new r;this.w=c;this.w.initialize(b,this);this.H=!1;this.G="en";this.ca=!1;this.I=null;this.o=new x;this.h=new vc;this.u=null;this.ua=1;this.c={};this.ba=new x;this.S=0;this.ta=!1;this.j={};this.V=this.T=this.W=null;this.K={}}q(X,C);n("shaka.player.StreamVideoSource",X);
X.prototype.D=function(a){null!=a.streamBufferSize&&(this.K.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.K.segmentRequestTimeout=a.segmentRequestTimeout);tf(this);null!=a.enableAdaptation&&this.w.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.aa=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.G=jb(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.H&&uf(this))};
X.prototype.destroy=function(){this.o.destroy();this.ba.destroy();this.ba=this.o=null;this.T&&(window.clearTimeout(this.T),this.T=null);this.W&&(window.clearTimeout(this.W),this.W=null);this.j=null;this.l.destroy();this.l=null;ya(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.w.destroy();this.i=this.h=this.I=this.f=this.g=this.U=this.w=null};l=X.prototype;
l.Ja=function(a,b){if(!this.H){var c=Error("Cannot call attach() right now.");c.type="stream";return Promise.reject(c)}this.i=a;this.f=b;this.I=a.$a();B(this.l,this.g,"sourceopen",this.mb.bind(this));B(this.l,this.U,"bandwidth",this.Gb.bind(this));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.o,c])};
l.Z=function(){if(this.H){var a=Error("Cannot call load() right now.");a.type="stream";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;gf(a);hf(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.H=!0;this.K.initialStreamBufferSize=this.a.c;tf(this);
uf(this);return Promise.resolve()};l.vb=function(){var a=Date.now(),b=this.W=null;this.Sa(this.a.g).then(z(this,function(a){b=new kf(a);return lf(b,this.a)})).then(z(this,function(c){b.destroy();b=null;for(var d=0;d<c.length;++d)vf(this,c[d]);this.K.initialStreamBufferSize=this.a.c;tf(this);uf(this);0==Object.keys(this.c).length?wf(this):xf(this,(Date.now()-a)/1E3)})).catch(z(this,function(a){b&&(b.destroy(),b=null);"aborted"!=a.type&&(a=E(a),this.dispatchEvent(a),this.a&&xf(this,0))}))};l.Sa=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
function vf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.oa()==b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.L&&a.J});if(0==f.length){e.push(b);return}a.j[c].Ha==b&&delete a.j[c];d.ra(f[0],!0);b.destroy()}b.destroy()}
l.ja=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.oa():null)?a.B:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.m.length;++f){var g=e.m[f];if(g.L&&g.J){var h=g.B,g=new mc(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ja;
X.prototype.pa=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.oa():null)?a.B:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.m.length;++g){var h=e.m[g];if(h.L&&h.J){var k=h.B,h=new Yb(k,h.bandwidth,f);k==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.pa;
X.prototype.Ga=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.oa():null,b=b?b.B:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.m.length;++h){var k=f.m[h].B,m=new Zb(k,g);k==b&&(m.active=!0,m.enabled=a.za());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Ga;X.prototype.Va=function(){var a=null,b;for(b in this.c){var c=this.c[b].Ea();0<c&&(a=null!=a?Math.min(a,c):c)}return a||0};
X.prototype.Na=function(){var a;if(this.H){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,he(a.a[c]));a=b}else a=[];return a};
X.prototype.Da=function(a){if(this.H){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.B]=e}this.b.a={};c=da(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var k=f[h];k.b.split(";")[0]==g&&this.b.push(e,b[k.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.ca=!0;if(a=this.b.get("audio"))yf(this,a),this.b.a.audio=a,a=a[0].lang||this.G,ib(2,this.G,
a)&&(this.ca=!1);if(a=this.b.get("text"))yf(this,a),this.b.a.text=a,a=a[0].lang||this.G,ib(2,this.G,a)||(this.ca=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return zf(this,"video",a,b,c)};l=X.prototype;l.Xa=function(a,b){return zf(this,"audio",a,b)};l.Ya=function(a,b){return zf(this,"text",a,b)};l.Fa=function(a){var b=this.c.text;b&&b.wa(a)};l.Za=function(a){this.V=a};
function uf(a){if(a.h){for(var b=!1,c=0;c<a.a.a.length;++c)for(var d=a.a.a[c],e=0;e<d.a.length;++e){var f=d.a[e];if("video"==f.contentType)for(var g=0;g<f.m.length;++g){var h=f.m[g],k=h.J;h.J=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.J=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.J=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.J=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&(h.J=!1);k!=h.J&&(b=!0)}}0!=ba(a.b).length&&b&&(Af(a),0<a.ja().length||(b=Error("The applicaion has restricted all video tracks!"),
b.type="stream",b=E(b),a.dispatchEvent(b)))}}l.va=function(){return[]};l.ea=function(){return!1};l.Wa=function(){return this.a?this.a.b:!1};
l.Ra=function(a){for(var b,c=!1,d=new r,e=ba(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.m.length;++h){var k=g.m[h];k.f.forEach(function(a){d.push(a,k)})}for(b in a)if(e=d.get(b))for(g=xa[a[b]]||null,f=0;f<e.length;++f)k=e[f],h=k.L,k.L=!g,h!=k.L&&(c=!0);else Ka(qa(b));c&&(Af(this),b=this.pa(),a=this.ja(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":b?"audio tracks.":
"video tracks.")),a.type="stream",a=E(a),this.dispatchEvent(a))};function Af(a){var b=D({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}function zf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],k=0;k<h.m.length;++k){var m=h.m[k];if(m.B==c){if(!m.L||!m.J)return!1;if("text"!=b&&!a.ta)return c=a.j[b],a.j[b]={Ha:m,Ka:null!=c&&c.Ka||d,La:null!=c&&c.La||e},!0;Xe(a.I,m);a.c[b].ra(m,d,e);return!0}}return!1}
function yf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(ib(c,a.G,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}l.mb=function(){this.l.sa(this.g,"sourceopen");wf(this).then(z(this,function(){this.o&&this.o.resolve()})).catch(z(this,function(a){this.o&&this.o.reject(a)}))};
function wf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Bf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=ya(f).map(function(a){return a.F.create()});return Promise.all(b).then(z(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Cf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Df(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.w.start();Ef(this,f,a);return Promise.resolve()})).catch(z(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.b?(xf(this,0),Promise.resolve()):Promise.reject(a)}))}
function Bf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.w.getInitialVideoTrackId();if(null==g)continue;f=e.m.filter(function(a){return a.B==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.m.filter(function(a){return a.L&&a.J});if(0==f.length)continue;f=e.m[Math.floor(f.length/2)]}else 0<e.m.length&&(f=e.m[0]);c[e.contentType]=f}return c}
function Df(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Ve(a,a.f):Ff(a,e);if(!e)return ya(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Ff(a,b){var c=new Ne(a,a.f,a.g,ee(b),a.U);c.H(a.K);return c}
function Ef(a,b,c){a.ua=a.f.playbackRate;a.f.playbackRate=0;Gf(a,c);var d;d=a.a.b?c.end:a.V&&a.V<=c.end&&a.V>=c.start?a.V:c.start;B(a.l,a.f,"seeking",a.rb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.u=d);Hf(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.bb(a.ba));B(a.l,d,"ended",a.tb.bind(a));var f=b[e];Xe(a.I,f);d.ra(f,!1)}Promise.all(c).then(a.ib.bind(a)).catch(z(a,function(a){"destroy"!=a.type&&(a=E(a),this.dispatchEvent(a))}));a.Fa(a.ca)}
l.ib=function(a){Ra(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=If(this);for(d=0;d<a.length;++d)a[d].ha(c);Jf(this,a,c);d=ba(this.b).map(function(a){return a.m}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.F.create()];a.C&&b.push(a.C.create());return Promise.all(b)});Promise.all(d).then(z(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ha(c);this.ta=
!0;for(var d in this.j)a=this.j[d],b=this.c[d],Xe(this.I,a.Ha),b.ra(a.Ha,a.Ka,a.La);this.j={}})).catch(z(this,function(a){"aborted"!=a.type&&(a=E(a),this.dispatchEvent(a))}))};function Jf(a,b,c){if(b=Cf(a,b))Gf(a,b),Hf(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.u=c):c=a.f.currentTime;a.a.b&&b&&(a.S=b.end-c,a.S=Math.max(a.S,0));a.f.playbackRate=a.ua;a.a.b&&null!=a.a.f&&xf(a,a.S);Kf(a);a.ba.resolve()}
function Gf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}l.wb=function(){this.T=null;Kf(this);var a=Cf(this,If(this));a&&(Hf(this,a.start,a.end),this.f.paused||Lf(this,this.f.currentTime,a.start,a.end))};function Hf(a,b,c){b=D({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}
l.rb=function(){var a=this.f.currentTime;if(null!=this.u){if(a>=this.u-.01&&a<=this.u+.01){this.u=null;return}this.u=null}var b=Cf(this,If(this));if(b){var c=b.end;(b=Lf(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].Ua()}};function Lf(a,b,c,d){if(b>=c-.01)return!1;a.f.currentTime=Math.min(c+(a.a.b?a.a.c:0),d);return!0}l.tb=function(){if(!this.a.b){for(var a in this.c)if(!this.c[a].Pa())return;this.g.endOfStream()}};
l.Gb=function(){var a=this.I,b=this.U.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new Ze(b))};function If(a){return ya(a.c).map(function(a){return a.Oa()}).filter(function(a){return null!=a})}
function Cf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e].Aa(),c=Math.max(c,f.start);null!=f.end&&(d=Math.min(d,f.end))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.S),c));return c>d?null:{start:c,end:d}}function xf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.W=window.setTimeout(a.vb.bind(a),1E3*c)}}function Kf(a){a.a.b&&(a.T=window.setTimeout(a.wb.bind(a),1E3))}
function tf(a){for(var b in a.c)a.c[b].H(a.K)};function Y(a,b,c,d){c||(c=new hb);d||(d=new W);X.call(this,null,c,d);this.ka=a;this.N=b;this.M=[];this.X=[];this.da=[];this.A=null}q(Y,X);n("shaka.player.DashVideoSource",Y);Y.prototype.la=function(a,b,c){this.M.push(a);this.X.push(b||"");this.da.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.la;Y.prototype.ma=function(a){this.A=a};Y.prototype.setNetworkCallback=Y.prototype.ma;Y.prototype.destroy=function(){this.A=this.N=null;X.prototype.destroy.call(this)};
Y.prototype.Z=function(){var a=new H(this.A,[new I(this.ka)]);return Cd(new Bd(a,this.aa)).then(z(this,function(a){for(var c=0;c<this.M.length;c++){var d=a,e=this.M[c],f=this.X[c],g=this.da[c];if(0!==d.a.length){var h=new Wc;h.contentType="text";h.lang=f||"en";h.c=!0;f=new Zc;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new I(e)];h.a.push(f);d.a[0].b.push(h);rd(d.a[0])}}this.a=te(new se(this.N),a,this.A);return X.prototype.Z.call(this)}))};
Y.prototype.Sa=function(a){return Cd(new Bd(a,this.aa)).then(z(this,function(a){a=te(new se(this.N),a,this.A);return Promise.resolve(a)}))};function Z(a,b,c){b||(b=new hb);c||(c=new W);X.call(this,null,b,c);this.X=a;this.M=[];this.timeoutMs=3E4;this.A={};this.N=null}q(Z,X);n("shaka.player.OfflineVideoSource",Z);Z.prototype.D=function(a){null!=a.licenseRequestTimeout&&(this.A.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.A.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.D.call(this,a)};
n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new vb,b=ob(a).then(function(){return wb(a)});b.then(function(){F(a)}).catch(function(){F(a)});return b});
Z.prototype.ma=function(a,b,c,d){var e,f={},g=[];a=new H(this.N,[new I(a)]);return Cd(new Bd(a,this.aa)).then(z(this,function(a){this.a=te(new se(c),a,this.N);if(this.a.b)return Promise.reject(Error("Unable to store live streams offline."));this.D({preferredLanguage:b});return X.prototype.Z.call(this)})).then(z(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new Ee(null,a,this);null!=this.A.licenseRequestTimeout&&(e.u=Number(this.A.licenseRequestTimeout));
B(this.l,e,"sessionReady",this.da.bind(this));return e.initialize()})).then(z(this,function(){for(var a=ba(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.m.length;++e){var g=c.m[e];f[g.B]=g}return d()})).then(z(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=f[c];if(d)g.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];g=g.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=g.map(function(a){return a.C.create()});return Promise.all(a)})).then(z(this,
function(a){for(var b=g,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(ee(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(z(this,function(){return He(e,this.timeoutMs)})).then(z(this,function(){return Mf(this,g,e.a,this.a.a[0].b)}))};n("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.ma);
Z.prototype.la=function(a){this.N=a};Z.prototype.setNetworkCallback=Z.prototype.la;Z.prototype.da=function(a){this.M.push(a.detail.sessionId)};function Mf(a,b,c,d){var e=new le(a.U,a);null!=a.A.segmentRequestTimeout&&(e.b=Number(a.A.segmentRequestTimeout));return ob(e).then(z(a,function(){return me(e,b,this.M,d,c)})).then(function(a){F(e);return Promise.resolve(a)}).catch(function(a){F(e);return Promise.reject(a)})}
Z.prototype.Z=function(){var a=new vb,b,c;return ob(a).then(z(this,function(){return xb(a,this.X)})).then(z(this,function(d){var e=[];this.M=d.session_ids;b=d.duration;c=d.key_system;for(var f=0;f<d.stream_ids.length;++f)e.push(yb(a,d.stream_ids[f]));return Promise.all(e)})).then(z(this,function(a){var e=b,f=c,g=new ke;g.c=5;for(var h=new je,k=0;k<a.length;++k){var m=a[k],p=new ce,t=new $d(m.references),y=new Uint8Array(m.init_segment),y=new I("data:application/octet-stream;base64,"+ua(y)),y=new be(new H(this.N,
[y],0,null));p.F=t;p.C=y;p.a=m.mime_type;p.b=m.codecs;p.L=!0;m=pc({keySystem:f,licenseServerUrl:""});t=new fe;t.m.push(p);t.a.push(m);t.contentType=p.a.split("/")[0];h.a.push(t);h.b=e}g.a.push(h);this.a=g;return X.prototype.Z.call(this)})).then(function(){F(a);return Promise.resolve()}).catch(function(b){F(a);return Promise.reject(b)})};
Z.prototype.ka=function(){var a=new le(null,null);return ob(a).then(z(this,function(){return pe(a,this.X)})).then(function(){F(a);return Promise.resolve()}).catch(function(b){F(a);return Promise.reject(b)})};Z.prototype.deleteGroup=Z.prototype.ka;Z.prototype.va=function(){return this.M};Z.prototype.ea=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

